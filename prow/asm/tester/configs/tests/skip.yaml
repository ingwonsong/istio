tests:
  - selectors:
      control_plane: unmanaged
    targets:
    - names:
        - TestProxyStatus
        - TestWait
        - TestVersion
      reason: istioctl does not work
    - names:
        - TestAnalysisWritesStatus
      reason: require custom installation
    - names:
        - TestDashboard
      reason: relies on istiod in cluster
    - names:
        - TestCustomizeMetrics
      reason: relies on istiod in cluster
      buganizerID: 177606974
    - names:
        - TestStackdriverAudit
      buganizerID: 183508169
    - names:
      - TestSimpleTlsOrigination
      - TestMutualTlsOrigination
      reason: relies on egress gateway deployed to cluster
    - names:
        - TestClusterLocal/cross_cluster
      buganizerID: 189899338
    - names:
        - TestTraffic/virtualservice/shifting-*
      buganizerID: 189899340
    - names:
        - TestRemoteClusters
      buganizerID: 194713967
    - names:
      - TestReachability/beta-mtls-on/.*/.*multiversion
      buganizerID: 237680146
    
  # Multiversion test skips.
  - selectors:
      multiversion: true
    targets:
      # networking/
      - names:
          - TestValidation/.*
        buganizerID: 207384361
      - names:
          - TestTraffic/virtualservice/redirect_port_and_scheme/.*
        buganizerID: 198205125
      - names:
          - TestTraffic/host/ip/.*
        buganizerID: 207384317
      - names:
          - TestClusterLocal
        buganizerID: 207384171
      - names:
          - TestTraffic/dns/.*
          - TestTraffic/serverfirst/.*
          - TestXFFGateway
          - TestXdsProxyStatus
        buganizerID: 187956450
        reason: UNKNOWN
      - names:
          - TestEmptyCluster
          - TestKubeOnly
          - TestFileAndKubeCombined
          - TestAllNamespaces
        reason: validation tests fail because of missing istio-injection on namespaces under compat mode
        buganizerID: 187956450
      - names:
          - TestCustomGateway
        reason: istio-injection=disabled on the namespace
      - names:
          - TestAddToAndRemoveFromMesh
        reason: istioctl x add-to-mesh does not work with revisions

      # security/
      - names:
          - TestRequestAuthentication
        buganizerID: 207384362
      - names:
          - TestReachability/automtls-passthrough.*
        reason: UNKNOWN
      - names:
        - TestReachability/beta-mtls-on/.*/.*multiversion
        buganizerID: 237680146
      - names:
          - TestAuthz_Conditions
        reason: relies on specific pod IP when creating authz policies
      - names:
          - TestNormalization
        reason: uses ctx.Settings().Revision to modify singular CM
      - names:
          - TestPassThroughFilterChain
        reason: requires PR 28601, should add RequireIstioVersion to the test in OSS and then unskip.
        buganizerID: 194120617

      # telemetry/
      - names:
          - TestStackdriverLegacy
          - TestStackdriverAuditLogging
          - TestStackdriverHTTPAuditLogging
          - TestStackdriverAuthz
          - TestVMTelemetry
        buganizerID: 187956450

  # Unmanaged CP + GKE_ON_PREM
  - selectors:
      control_plane: unmanaged
      cluster_type: gke-on-prem
    targets:
    # pilot/ tests
    - names:
        - TestXFFGateway
      buganizerID: 201558623
    - names:
      - TestCustomGateway/helm
      - TestBadWasmRemoteLoad
      - TestStackdriverLegacy
      - TestStackdriverAuditLogging
      - TestStackdriverHTTPAuditLogging
      - TestStackdriverAuthz
      buganizerID: 202282289
    - names:
      - TestTraffic/dns/.*
      buganizerID: 191802552

  # Unmanaged CP + bare-metal
  - selectors:
      control_plane: unmanaged
      cluster_type: bare-metal
    targets:
      # pilot/ tests
      - names:
          - TestTraffic/serverfirst/auto-tcp-server.*
          - TestCustomGateway
          - TestAddToAndRemoveFromMesh
          - TestGateway
          - TestVMRegistrationLifecycle
          - TestValidation
          - TestServiceExports*
          - TestTraffic/dns
          - TestIngress/update-class-not-istio
          - TestTraffic/consistent-hash/query_param
        buganizerID: 187725074
      - names:
        - TestTraffic/jwt-claim-route
        reason: Temporary disable until mesh agent upgraded to 1.11.2

      # security/ tests
      - names:
          - TestTlsGatewaysWithQUIC/quic*
          - TestMtlsGatewaysWithQUIC/quic*
        buganizerID: 199551889
        reason: Requires MixedProtocolLBService k8s alpha feature flag which isn't something we can turn on. It is not supported in ASM.
      - names:
          - TestStrictMTLS
        reason: MeshCA does not support ECDSA
      - names:
          - TestAuthz_Custom
        reason: requires mesh config
      - names:
          - TestStackdriverLegacy
          - TestStackdriverAuditLogging
          - TestStackdriverHTTPAuditLogging
          - TestStackdriverAuthz
          - TestVMTelemetry
        reason: Stackdriver is not enabled with ASM Distro Baremetal installation

      # telemetry/ tests
      - names:
          - TestCanonicalServices
        buganizerID: 203557135
      - names:
          - TestTelemetryAPITCPStats
        buganizerID: 205336277
      - names:
          - TestStackdriverLegacy
          - TestStackdriverAudit
          - TestVMTelemetry
        reason: Stackdriver is not enabled with ASM Distro Baremetal installation

  # Unmanaged CP + bare-metal
  - selectors:
      control_plane: unmanaged
      cluster_type: bare-metal
      cluster_topology: mcmn
    targets:
    - names:
      - TestBadRemoteSecret
      - TestTraffic/sniffing/http/headless.*
      - TestTraffic/sniffing/grpc/headless.*
      buganizerID: 205190928
    - names:
      - TestClusterLocal/subsets
      buganizerID: 209865846

  # Unmanaged CP + gcp-and-bare-metal hybrid
  - selectors:
      control_plane: unmanaged
      cluster_type: hybrid-gke-and-bare-metal
    targets:
    # pilot/ tests
    - names:
      - TestTraffic/serverfirst/auto-tcp-server.*
      - TestCustomGateway
      - TestAddToAndRemoveFromMesh
      - TestGateway
      - TestVMRegistrationLifecycle
      - TestValidation
      - TestServiceExports*
      - TestTraffic/dns
      - TestIngress/update-class-not-istio
      - TestTraffic/consistent-hash/query_param
      buganizerID: 187725074
    - names:
      - TestTraffic/jwt-claim-route
      reason: Temporary disable until mesh agent upgraded to 1.11.2
    - names:
      - TestBadRemoteSecret
      - TestTraffic/sniffing/http/headless.*
      - TestTraffic/sniffing/grpc/headless.*
      buganizerID: 205190928
    - names:
      - TestClusterLocal/subsets
      buganizerID: 209865846

    # security/ tests
    - names:
      - TestTlsGatewaysWithQUIC/quic*
      - TestMtlsGatewaysWithQUIC/quic*
      buganizerID: 199551889
      reason: Requires MixedProtocolLBService k8s alpha feature flag which isn't something we can turn on. It is not supported in ASM.
    - names:
      - TestStrictMTLS
      reason: MeshCA does not support ECDSA
    - names:
      - TestAuthz_Custom
      reason: requires mesh config
    - names:
      - TestStackdriverLegacy
      - TestStackdriverAuditLogging
      - TestStackdriverHTTPAuditLogging
      - TestStackdriverAuthz
      - TestVMTelemetry
      reason: Stackdriver is not enabled with ASM Distro Baremetal installation

    # telemetry/ tests
    - names:
      - TestCanonicalServices
      buganizerID: 203557135
    - names:
      - TestTelemetryAPITCPStats
      buganizerID: 205336277

  # Unmanaged CP + gcp-and-eks hybrid
  - selectors:
      control_plane: unmanaged
      cluster_type: hybrid-gke-and-eks
    targets:
    # pilot/ tests
    - names:
      - TestTraffic/serverfirst/auto-tcp-server.*
      - TestCustomGateway
      - TestMultiVersionRevision
      - TestAddToAndRemoveFromMesh
      - TestGateway
      - TestRevisionedUpgrade
      - TestVMRegistrationLifecycle
      - TestValidation
      - TestRevision*
      - TestMultiRevision
      - TestUninstall*
      - TestServiceExports*
      - TestTraffic/dns
      - TestIngress/update-class-not-istio
      - TestTraffic/consistent-hash/query_param
      buganizerID: 187725074
    - names:
      - TestTraffic/jwt-claim-route
      reason: Temporary disable until mesh agent upgraded to 1.11.2
    - names:
      - TestBadRemoteSecret
      - TestTraffic/sniffing/http/headless.*
      - TestTraffic/sniffing/grpc/headless.*
      buganizerID: 205190928
    - names:
      - TestClusterLocal/subsets
      buganizerID: 209865846

    # security/ tests
    - names:
      - TestTlsGatewaysWithQUIC/quic*
      - TestMtlsGatewaysWithQUIC/quic*
      buganizerID: 199551889
      reason: Requires MixedProtocolLBService k8s alpha feature flag which isn't something we can turn on. It is not supported in ASM.
    - names:
      - TestStrictMTLS
      reason: MeshCA does not support ECDSA
    - names:
      - TestAuthz_Custom
      reason: requires mesh config
    - names:
      - TestStackdriverLegacy
      - TestStackdriverAuditLogging
      - TestStackdriverHTTPAuditLogging
      - TestStackdriverAuthz
      - TestVMTelemetry
      reason: Stackdriver is not enabled with ASM Distro Baremetal installation

    # telemetry/ tests
    - names:
      - TestCanonicalServices
      buganizerID: 203557135
    - names:
      - TestTelemetryAPITCPStats
      buganizerID: 205336277

  # Unmanaged CP + apm
  - selectors:
      control_plane: unmanaged
      cluster_type: apm
    targets:
      - names:
          - TestStackdriverLegacy
          - TestStackdriverAuditLogging
          - TestStackdriverHTTPAuditLogging
          - TestStackdriverAuthz
          - TestVMTelemetry
        reason: Stackdriver is not enabled with ASM Distro Baremetal installation
      # pilot/ tests
      - names:
        - TestCustomGateway/helm
        - TestAddToAndRemoveFromMesh
        - TestIngress
        - TestServiceExports/exported/0/create
        - TestTraffic/dns
        - TestTraffic/consistent-hash
        buganizerID: 191913525
      - names:
        - TestTraffic/jwt-claim-route
        reason: Temporary disable until mesh agent upgraded to 1.11.2

  # Unmanaged CP + aws
  - selectors:
      control_plane: unmanaged
      cluster_type: aws
    targets:
      # security/ tests
      - names:
          - TestStrictMTLS
        reason: MeshCA does not support ECDSA
      - names:
          - TestAuthz_Custom
        reason: requires mesh config
      - names:
          - TestSingleTlsGateway*
          - TestSingleMTLSGateway*
          - TestTlsGatewaysWithQUIC/quic*
          - TestMtlsGatewaysWithQUIC/quic*
          - TestTlsGateways
          - TestMtlsGateways
        buganizerID: 200846058
        reason: Requires MixedProtocolLBService k8s alpha feature flag which isn't something we can turn on. It is not supported in ASM.

      # telemetry/ tests
      - names:
          - TestCanonicalServices
        buganizerID: 203557135
      - names:
          - TestStackdriverLegacy
          - TestStackdriverAuditLogging
          - TestStackdriverHTTPAuditLogging
          - TestStackdriverAuthz
          - TestVMTelemetry
        reason: Stackdriver is not enabled with ASM Distro installation
      - names:
          - TestTelemetryAPITCPStats
        buganizerID: 205336277

      # networking/ tests
      - names:
        - TestCustomGateway/helm
        - TestAddToAndRemoveFromMesh
        - TestServiceExports/exported/0/create
        - TestTraffic/dns
        - TestXdsVersion
        - TestXdsProxyStatus
        buganizerID: 187722953
      - names:
        - TestTraffic/jwt-claim-route
        reason: Temporary disable until mesh agent upgraded to 1.11.2
      - names:
        - TestDescribe
        buganizerID: 208485368

  # Unmanaged CP + azure
  - selectors:
      control_plane: unmanaged
      cluster_type: azure
    targets:
      # security/ tests
      - names:
          - TestTlsGatewaysWithQUIC/quic*
          - TestMtlsGatewaysWithQUIC/quic*
        buganizerID: 230904931
        reason: Requires MixedProtocolLBService k8s alpha feature flag which isn't something we can turn on. It is not supported in ASM.

      # telemetry/ tests
      - names:
          - TestStackdriverLegacy
          - TestStackdriverAuditLogging
          - TestStackdriverHTTPAuditLogging
          - TestStackdriverAuthz
          - TestVMTelemetry
        reason: Stackdriver is not enabled with ASM Distro installation

      # networking/ tests
      - names:
        - TestCustomGateway/helm
        - TestAddToAndRemoveFromMesh
        - TestTraffic/dns
        buganizerID: 230795812
      - names:
        - TestTraffic/jwt-claim-route
        reason: Temporary disable until mesh agent upgraded to 1.11.2

  # Unmanaged CP + EKS (don't confuse with regular AWS)
  - selectors:
      control_plane: unmanaged
      cluster_type: eks
    targets:
      # security/ tests
      - names:
          - TestStrictMTLS
        reason: MeshCA does not support ECDSA
      - names:
          - TestAuthz_Custom
        reason: requires mesh config
      - names:
          - TestTlsGatewaysWithQUIC/quic*
          - TestMtlsGatewaysWithQUIC/quic*
        reason: Experemental code.
      # telemetry/ tests
      - names:
          - TestStackdriverLegacy
          - TestStackdriverAuditLogging
          - TestStackdriverHTTPAuditLogging
          - TestStackdriverAuthz
          - TestStackdriverAudit
          - TestVMTelemetry
        reason: Stackdriver is not enabled with ASM Distro installation
      - names:
        - TestTelemetryAPITCPStats
        buganizerID: 205336277
      # networking/ tests
      - names:
        - TestCustomGateway/helm
        - TestAddToAndRemoveFromMesh
        - TestServiceExports/exported/0/create
        - TestTraffic/dns
        - TestXdsVersion
        - TestXdsProxyStatus
        buganizerID: 187722953

  # Unmanaged CP + AKS
  - selectors:
      control_plane: unmanaged
      cluster_type: aks
    targets:
      # security/ tests
      - names:
          - TestStrictMTLS
        reason: MeshCA does not support ECDSA
      - names:
          - TestAuthz_Custom
        reason: requires mesh config
      - names:
          - TestTlsGatewaysWithQUIC/quic*
          - TestMtlsGatewaysWithQUIC/quic*
        buganizerID: 230904931
        reason: Requires MixedProtocolLBService k8s alpha feature flag which isn't something we can turn on. It is not supported in ASM.
      # telemetry/ tests
      - names:
          - TestStackdriverLegacy
          - TestStackdriverAuditLogging
          - TestStackdriverHTTPAuditLogging
          - TestStackdriverAuthz
          - TestVMTelemetry
        reason: Stackdriver is not enabled with ASM Distro installation
      - names:
        - TestTelemetryAPITCPStats
        buganizerID: 205336277
      # networking/ tests
      - names:
        - TestCustomGateway/helm
        - TestAddToAndRemoveFromMesh
        - TestServiceExports/exported/0/create
        - TestTraffic/dns
        - TestXdsVersion
        - TestXdsProxyStatus
        buganizerID: 187722953

  # Unmanaged CP + Openshift
  - selectors:
      control_plane: unmanaged
      cluster_type: openshift
    targets:
      # security/ tests
      - names:
          - TestTlsGatewaysWithQUIC/quic*
          - TestMtlsGatewaysWithQUIC/quic*
        reason: Requires MixedProtocolLBService k8s alpha feature flag which isn't something we can turn on. It is not supported in ASM.
      # networking/ tests
      - names:
        - TestTcpProbe
        - TestAddToAndRemoveFromMesh
        - TestCustomGateway/minimal
        - TestCustomGateway/helm
        - TestCustomGateway/helm-simple
        - TestXFFGateway
        - TestGatewayConformance
      # telemetry/ tests
      - names:
        - TestStackdriverLegacy
        - TestStackdriverAuditLogging
        - TestStackdriverHTTPAuditLogging
        - TestStackdriverAuthz

  # Unmanaged CP, cluster topology = mc, feature = VPC_SC
  # Keep the skipped test cases same as unmanaged cp, mp
  - selectors:
      control_plane: unmanaged
      cluster_topology: mc
      feature_to_test: VPC_SC
    targets:
    - names:
      - TestStatsFilter
      - TestTcpMetric
      - TestWasmStatsFilter
      - TestWasmTcpMetric
      buganizerID: 177606974
    # pilot/ tests
    - names:
      - TestTraffic/dns.*
      buganizerID: 191802552

  # Unmanaged CP, cluster topology = mp OR multiproject
  - selectors:
      control_plane: unmanaged
      cluster_topology: mp
    targets:
      - names:
          - TestStatsFilter
          - TestTcpMetric
          - TestWasmStatsFilter
          - TestWasmTcpMetric
        buganizerID: 177606974
      # pilot/ tests
      - names:
          - TestTraffic/dns.*
        buganizerID: 191802552

  # Unmanaged CP, cluster topology = mc OR multiproject
  - selectors:
      control_plane: unmanaged
      cluster_topology: mc
    targets:
      - names:
          - TestStatsFilter
          - TestTcpMetric
          - TestWasmStatsFilter
          - TestWasmTcpMetric
        buganizerID: 177606974
      # pilot/ tests
      - names:
          - TestTraffic/dns.*
        buganizerID: 191802552

  # MCP test skips
  - selectors:
      control_plane: managed
    targets:
      # pilot/ tests
      - names:
          - TestWait
          - TestVersion
          - TestProxyStatus
          - TestXdsProxyStatus
          - TestDescribe
        reason: istioctl doesn't work
      - names:
          - TestTraffic/dns.*
        buganizerID: 191802552
      - names:
        - TestReachability/no-peer-authn/headless.*
        - TestReachability/no-peer-authn/naked.*
        buganizerID: 192372391
      - names:
        - TestReachability/beta-mtls.*/headless.*
        buganizerID: 192372862
      - names:
        - TestReachability/beta-mtls-on/.*/.*multiversion
        buganizerID: 237680146
      - names:
          - TestXdsVersion
        buganizerID: 184572948
      - names:
          - TestAnalysisWritesStatus
        reason: requires custom installation
      - names:
          - TestVMRegistrationLifecycle
        reason: attempts to interact with istiod directly
      - names:
          - TestValidation
          - TestWebhook
        buganizerID: 170404545
      - names:
          - TestAddToAndRemoveFromMesh
        reason: test doesn't respect --istio.test.revision istio.test.revision
      - names:
          - TestRemoteClusters
        buganizerID: 194713967
      - names:
          - TestTlsGatewaysWithQUIC/quic
          - TestMtlsGatewaysWithQUIC/quic
        reason: Experemental code. Not supported by GKE
      - names:
          - TestTunnelingOutboundTraffic
        buganizerID: 236717015

      # telemetry/ tests
      - names:
          - TestStackdriverAudit
          - TestStackdriverHTTPAuditLogging
        reason: relies on custom Stackdriver EnvoyFilter
      - names:
          - TestIstioctlMetrics
        reason: istioctl doesn't work
      - names:
          - TestBadWasmRemoteLoad
          - TestWasmStatsFilter
          - TestWasmTcpMetric
        reason: relies on enabling WASM on install
      - names:
          - TestDashboard
        reason: relies on istiod in cluster
      - names:
          - TestProxyTracing
          - TestClientTracing
          - TestRateLimiting
        reason: requires custom meshConfig setting
      - names:
          - TestCustomizeMetrics
        reason: relies on customization on stats EnvoyFilter
      - names:
          - TestOutboundTrafficPolicy
        reason: relies on egress gateway deployed to the cluster
      - names:
          - TestStackdriverAudit
        buganizerID: 183508169
      - names:
          - TestCNI19Upgrade
        reason: no longer needed

      # security/ tests
      - names:
        - TestAuthz_IngressGateway
        reason: http://b/193076663
      - names:
        - TestAuthz_EgressGateway
        reason: http://b/193077583
      - names:
          - TestStrictMTLS
        reason: Mesh CA does not support ECDSA
      - names:
          - TestAuthz_Custom
        reason: requires mesh config
      - names:
          - TestTelemetry
        buganizerID: 190420441
      - names:
          - TestSimpleTlsOrigination
          - TestMutualTlsOrigination
        buganizerID: 219498565
      - names:
        - TestReachability/global_mtls_disabled
        - TestReachability/global_plaintext_to_mtls_permissive
        - TestReachability/global_automtls_disable
        - TestReachability/global_automtls_passthrough
        - TestReachability/mtls_disabled
        buganizerID: 238942267

      # cloudesf/tests
      - names:
          - TestCloudESFApiKeyGrpc
          - TestCloudESFGrpcEcho
        reason: it requires installing istiod first
  - selectors:
      gce_vms: true
    targets:
      - names:
          - TestTraffic/dns/a/.*
          - TestTraffic/dns/tproxy/.*
        reason: Delay or breakage in resolving SE from Pods
        buganizerID: 190209498
      - names:
          - TestValidation
        reason: incompatible with stableNamespaces flag
      - names:
          - TestReachability/no-peer-authn/headless.*
          - TestReachability/no-peer-authn/naked.*
        buganizerID: 192372391
      - names:
          - TestStackdriverLegacy
          - TestStackdriverAuditLogging
          - TestStackdriverHTTPAuditLogging
          - TestStackdriverAuthz
        buganizerID: 187956450
      - names:
          - TestWorkloadEntryUpdatesStatus
        buganizerID: 198725015

  # Managed CP, cluster topology = sc OR SINGLECLUSTER
  - selectors:
      control_plane: managed
      cluster_topology: sc
    targets:
      - names:
          - TestStackdriverMonitoring
        reason: Not needed, multi-cluster MCP telemetry tests use real stackdriver.
      - names:
          - TestTelemetry/telemetry
        reason: Prometheus shouldn't be tested for MCP. We have a separate test for real stackdriver.

  # Managed CP, cluster topology = sc OR SINGLECLUSTER, feature = VPC_SC
  - selectors:
      control_plane: managed
      cluster_topology: sc
      feature_to_test: VPC_SC
    targets:
    - names:
      - TestTraffic/use-client-protocol/use_client_protocol_with_h2
      reason: Unknown
      buganizerID: 195128010
    - names:
      - TestTraffic/instanceip/instance_IP_without_sidecar
      - TestTraffic/instanceip/instance_IP_with_empty_sidecar
      - TestTraffic/instanceip/localhost_IP_with_empty_sidecar
      - TestTraffic/instanceip/localhost_IP_without_sidecar
      reason: Unkown
      buganizerID: 195128010
    - names:
      - TestTraffic/virtualservice/set_authority_header*
      reason: Unknown
      buganizerID: 195128010
    - names:
      - TestTraffic/jwt-claim-route
      reason: From http://gkecl/359561, Temporary disable until mesh agent upgraded to 1.11.2.
    - names:
      - TestTraffic/host/ip/auto-http
      - TestTraffic/host/ip:18081/auto-http
      - TestTraffic/virtualservice/rewrite_uri
      reason: Unknown
      buganizerID: 195128010
    - names:
      - TestTraffic/sniffing/http10_to_http
      - TestTraffic/sniffing/http10_to_auto
      - TestTraffic/sniffing/http10_to_external
      - TestTraffic/sniffing/http10_to_external_auto
      reason: Unknown
      buganizerID: 195128010

  # Managed local CP skips all tests that are skipped by unmanaged
  - selectors:
      control_plane: managed_local
    targets:
    - names:
        - TestProxyStatus
        - TestWait
        - TestVersion
      reason: istioctl does not work
    - names:
        - TestReachability/beta-mtls.*/headless.*
      buganizerID: 192372862
    - names:
        - TestAnalysisWritesStatus
        - TestRequestAuthentication/.*/valid-token-forward-remote-jwks
      reason: require custom installation
    - names:
        - TestDashboard
      reason: relies on istiod in cluster
    - names:
        - TestCustomizeMetrics
      reason: relies on istiod in cluster
      buganizerID: 177606974
    - names:
        - TestStackdriverAudit
      buganizerID: 183508169
    - names:
        - TestAuthz_IngressGateway
      reason: unknown
    - names:
        - TestSimpleTlsOrigination
        - TestMutualTlsOrigination
      reason: relies on egress gateway deployed to cluster
    - names:
        - TestClusterLocal/cross_cluster
      buganizerID: 189899338
    - names:
        - TestTraffic/virtualservice/shifting-*
      buganizerID: 189899340
    - names:
        - TestRemoteClusters
      buganizerID: 194713967

  # Managed local CP + GKE_ON_PREM skips all tests that
  # are skipped by Umanaged local CP + GKE_ON_PREM
  - selectors:
      control_plane: managed_local
      cluster_type: gke-on-prem
    targets:
    # pilot/ tests
    - names:
        - TestXFFGateway
      buganizerID: 201558623
    - names:
      - TestCustomGateway/helm
      - TestBadWasmRemoteLoad
      - TestStackdriverLegacy
      - TestStackdriverAuditLogging
      - TestStackdriverHTTPAuditLogging
      - TestStackdriverAuthz
      buganizerID: 202282289
    - names:
      - TestTraffic/dns/.*
      buganizerID: 191802552
    - names:
      - TestReachability/beta-mtls.*/.*/.*headless.*
      - TestReachability/no-peer.*/.*/.*headless.*
      buganizerID: 197235650
    # This test is skipped in MCP
    - names:
        - TestValidation
        - TestWebhook
      buganizerID: 170404545
    # This test is skipped in MCP and other multicloud envs
    - names:
        - TestAddToAndRemoveFromMesh
      reason: test doesn't respect --istio.test.revision
    # This test is skipped in a few multcloud envs.
    - names:
      - TestDescribe
      buganizerID: 208485368

  # Kubevirt
  - selectors:
      deployment_type: kubevirt_vm
    targets:
    - names:
      - TestTelemetryAPIStats/mockprom-to-metrics
      reason: unable to share istio-proxy certs to kubevirt vms

packages:

  # skip endpointslice package
  - selectors:
      all: true
    targets:
    - reason: we never re-install control plane to use endpointslice mode, dupe of default pilot suite
      names:
      - /pilot/endpointslice

  - selectors:
      control_plane: unmanaged
    targets:
      - names:
          - /pilot/cni
          - /security/ca_migration
        reason: not supported
      - names:
          - /telemetry/stats/prometheus/nullvm
          - /telemetry/stats/prometheus/wasm
        buganizerID: 184312874

 # Managed local CP skips all tests that are skipped by unmanaged.
  - selectors:
      control_plane: managed_local
    targets:
      - names:
          - /pilot/cni
          - /security/ca_migration
        reason: not supported
      - names:
          - /telemetry/stats/prometheus/nullvm
          - /telemetry/stats/prometheus/wasm
        buganizerID: 184312874

  # MCP single cluster tests skips the following packages.
  - selectors:
      control_plane: managed
      cluster_topology: sc
    targets:
      - names:
          - /multicluster
          - /helm
          - /operator
          - /pilot/cni
          - /pilot/revisions
          - /pilot/revisioncmd
          - /telemetry/stackdriver/vm
          - /telemetry/stats/prometheus/customizemetrics
          - /telemetry/stats/prometheus/wasm
        reason: not supported
      - names:
          - /pilot/mcs
        buganizerID: 183429870
      - names:
          - /mdp/controller
        reason: requires setup of CNI and multiversion of CP
      - names:
          - /mdp/installation
        reason: tests meant for asmcli install in VPC-SC environment

  # MLCP single cluster tests skips the following packages.
  - selectors:
      control_plane: managed_local
      cluster_topology: sc
    targets:
      - names:
          - /multicluster
          - /helm
          - /operator
          - /pilot/cni
          - /pilot/revisions
          - /pilot/revisioncmd
          - /telemetry/stackdriver/vm
          - /telemetry/stats/prometheus/customizemetrics
          - /telemetry/stats/prometheus/wasm
        reason: not supported
      - names:
          - /pilot/mcs
        buganizerID: 183429870
      - names:
          - /mdp/controller
        reason: requires setup of CNI and multiversion of CP
      - names:
          - /mdp/installation
        reason: tests meant for asmcli install in VPC-SC environment

  # MCP multi-cluster tests skips the following packages.
  - selectors:
      control_plane: managed
      cluster_topology: mc
    targets:
    - names:
      - /helm
      - /operator
      - /pilot/cni
      - /pilot/revisions
      - /pilot/revisioncmd
      - /telemetry/stackdriver/vm
      - /telemetry/stats/prometheus/customizemetrics
      - /telemetry/stats/prometheus/wasm
      reason: not supported
    - names:
      - /pilot/mcs
      buganizerID: 183429870
    - names:
      - /mdp/controller
      reason: requires setup of CNI and multiversion of CP
    - names:
      - /mdp/installation
      reason: tests meant for asmcli install in VPC-SC environment

  # MCP multi-project tests skips the following packages that's skipped by multi-cluster.
  - selectors:
      control_plane: managed
      cluster_topology: mp
    targets:
    - names:
      - /helm
      - /operator
      - /pilot/cni
      - /pilot/revisions
      - /pilot/revisioncmd
      - /telemetry/stackdriver/vm
      - /telemetry/stats/prometheus/customizemetrics
      - /telemetry/stats/prometheus/wasm
      reason: not supported
    - names:
      - /pilot/mcs
      buganizerID: 183429870
    - names:
      - /mdp/controller
      reason: requires setup of CNI and multiversion of CP
    - names:
      - /mdp/installation
      reason: tests meant for asmcli install in VPC-SC environment
